05201002    今井航一

init_task関数ではスタックの初期化を行うため、ss,rsp,rflags,cs,ripを順に積むものとした。

init_tasks関数ではinit_task関数を用いて最初に行うタスク以外のスタックを初期化し、さらに最初のタスクを呼び出すものとした。

schedule関数ではそれ以前に行っていたタスクのスタックポインタを保存した上でこれから行うタスクのスタックポインタを取り出して、汎用レジスタの値をpopを用いて復帰させることとした。



init_tasksの中で当初 
    asm volatile ("mov %0,%%rsp" ::"r"(stack1+STACK_SIZE));
とすべきところを
    asm volatile ("mov %0,%%rsp" ::"r"(stack1));
としてしまっており、スタックの一番上をスタックポインタが指している状態になっていた。それゆえプログラム実行時におおよそ期待通りの出力をするものの、出力文字が潰れたようなものが表示されスタック配列として確保した領域以外に書き込んでしまっていたと考えられる。